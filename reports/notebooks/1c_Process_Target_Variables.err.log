Traceback (most recent call last):
  File "/home/danbot2/code_5820/data_analysis/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/home/danbot2/code_5820/data_analysis/lib/python3.10/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/home/danbot2/code_5820/data_analysis/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 166, in wrapped
    return loop.run_until_complete(inner)
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/danbot2/code_5820/data_analysis/lib/python3.10/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/home/danbot2/code_5820/data_analysis/lib/python3.10/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/danbot2/code_5820/data_analysis/lib/python3.10/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
for b in bitrates:
    distortions[b] = []
    print(f'computing {b} bits')
    for err in error_models:
        t1 = time()
        inputs = (stn_df, test_stn, b, err)
        stn, kld, b, err = compute_error_bias(inputs)
        distortions[b].append(kld)
    
    err_labels = [100*e for e in error_models]
    distortion_fig.line(err_labels, distortions[b], line_width=2, line_color=Sunset10[n],
                   legend_label=f'{b} bits')
    n += 1

distortion_fig.legend.location = 'top_left'
distortion_fig.legend.click_policy = 'hide'
distortion_fig.xaxis.axis_label = r'$$\text{Error Model } [\%]$$'
distortion_fig.yaxis.axis_label = r'$$\text{Error Bias } [\text{bits}/\text{sample}]$$'
distortion_fig.add_layout(distortion_fig.legend[0], 'right')
------------------

----- stdout -----
computing 4 bits
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mValueError[0m                                Traceback (most recent call last)
Cell [0;32mIn[13], line 7[0m
[1;32m      5[0m     t1 [38;5;241m=[39m time()
[1;32m      6[0m     inputs [38;5;241m=[39m (stn_df, test_stn, b, err)
[0;32m----> 7[0m     stn, kld, b, err [38;5;241m=[39m [43mcompute_error_bias[49m[43m([49m[43minputs[49m[43m)[49m
[1;32m      8[0m     distortions[b][38;5;241m.[39mappend(kld)
[1;32m     10[0m err_labels [38;5;241m=[39m [[38;5;241m100[39m[38;5;241m*[39me [38;5;28;01mfor[39;00m e [38;5;129;01min[39;00m error_models]

Cell [0;32mIn[11], line 7[0m, in [0;36mcompute_error_bias[0;34m(inputs)[0m
[1;32m      5[0m bin_edges [38;5;241m=[39m dpf[38;5;241m.[39mcompute_log_uniform_bins(data, b, reserve_edges[38;5;241m=[39m[38;5;28;01mTrue[39;00m)
[1;32m      6[0m simple_frequencies [38;5;241m=[39m compute_idealized_frequencies(data, bin_edges, b)
[0;32m----> 7[0m error_adjusted_frequencies [38;5;241m=[39m [43mapply_error_to_observations[49m[43m([49m[43mdata[49m[43m,[49m[43m [49m[43mbin_edges[49m[43m,[49m[43m [49m[43mbitrate[49m[38;5;241;43m=[39;49m[43mb[49m[43m,[49m[43m [49m[43merror[49m[38;5;241;43m=[39;49m[43merr[49m[43m)[49m
[1;32m      8[0m [38;5;66;03m# compute KL divergence between the simple and adjusted frequencies[39;00m
[1;32m      9[0m [38;5;66;03m# this represents the distortion due to the error model[39;00m
[1;32m     10[0m mask [38;5;241m=[39m (simple_frequencies [38;5;241m>[39m [38;5;241m0[39m) [38;5;241m&[39m (error_adjusted_frequencies [38;5;241m>[39m [38;5;241m0[39m)

Cell [0;32mIn[9], line 15[0m, in [0;36mapply_error_to_observations[0;34m(data, bin_edges, bitrate, error)[0m
[1;32m     13[0m count_df [38;5;241m=[39m pd[38;5;241m.[39mDataFrame(index[38;5;241m=[39m[38;5;28mrange[39m([38;5;241m2[39m[38;5;241m*[39m[38;5;241m*[39mbitrate))
[1;32m     14[0m count_df[label] [38;5;241m=[39m [38;5;241m0[39m
[0;32m---> 15[0m count_df[label] [38;5;241m+[39m[38;5;241m=[39m fractional_counts
[1;32m     16[0m count_df[38;5;241m.[39mfillna([38;5;241m0[39m, inplace[38;5;241m=[39m[38;5;28;01mTrue[39;00m)
[1;32m     17[0m n_obs [38;5;241m=[39m np[38;5;241m.[39mnansum(count_df[label])

File [0;32m~/code_5820/data_analysis/lib/python3.10/site-packages/pandas/core/generic.py:12096[0m, in [0;36mNDFrame.__iadd__[0;34m(self, other)[0m
[1;32m  12094[0m [38;5;28;01mdef[39;00m [38;5;21m__iadd__[39m([38;5;28mself[39m: NDFrameT, other) [38;5;241m-[39m[38;5;241m>[39m NDFrameT:
[1;32m  12095[0m     [38;5;66;03m# error: Unsupported left operand type for + ("Type[NDFrame]")[39;00m
[0;32m> 12096[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_inplace_method[49m[43m([49m[43mother[49m[43m,[49m[43m [49m[38;5;28;43mtype[39;49m[43m([49m[38;5;28;43mself[39;49m[43m)[49m[38;5;241;43m.[39;49m[38;5;21;43m__add__[39;49m[43m)[49m

File [0;32m~/code_5820/data_analysis/lib/python3.10/site-packages/pandas/core/generic.py:12073[0m, in [0;36mNDFrame._inplace_method[0;34m(self, other, op)[0m
[1;32m  12068[0m [38;5;129m@final[39m
[1;32m  12069[0m [38;5;28;01mdef[39;00m [38;5;21m_inplace_method[39m([38;5;28mself[39m, other, op):
[1;32m  12070[0m [38;5;250m    [39m[38;5;124;03m"""[39;00m
[1;32m  12071[0m [38;5;124;03m    Wrap arithmetic method to operate inplace.[39;00m
[1;32m  12072[0m [38;5;124;03m    """[39;00m
[0;32m> 12073[0m     result [38;5;241m=[39m [43mop[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43mother[49m[43m)[49m
[1;32m  12075[0m     [38;5;28;01mif[39;00m (
[1;32m  12076[0m         [38;5;28mself[39m[38;5;241m.[39mndim [38;5;241m==[39m [38;5;241m1[39m
[1;32m  12077[0m         [38;5;129;01mand[39;00m result[38;5;241m.[39m_indexed_same([38;5;28mself[39m)
[1;32m  12078[0m         [38;5;129;01mand[39;00m is_dtype_equal(result[38;5;241m.[39mdtype, [38;5;28mself[39m[38;5;241m.[39mdtype)
[1;32m  12079[0m     ):
[1;32m  12080[0m         [38;5;66;03m# GH#36498 this inplace op can _actually_ be inplace.[39;00m
[1;32m  12081[0m         [38;5;28mself[39m[38;5;241m.[39m_values[:] [38;5;241m=[39m result[38;5;241m.[39m_values

File [0;32m~/code_5820/data_analysis/lib/python3.10/site-packages/pandas/core/ops/common.py:72[0m, in [0;36m_unpack_zerodim_and_defer.<locals>.new_method[0;34m(self, other)[0m
[1;32m     68[0m             [38;5;28;01mreturn[39;00m [38;5;28mNotImplemented[39m
[1;32m     70[0m other [38;5;241m=[39m item_from_zerodim(other)
[0;32m---> 72[0m [38;5;28;01mreturn[39;00m [43mmethod[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43mother[49m[43m)[49m

File [0;32m~/code_5820/data_analysis/lib/python3.10/site-packages/pandas/core/arraylike.py:102[0m, in [0;36mOpsMixin.__add__[0;34m(self, other)[0m
[1;32m    100[0m [38;5;129m@unpack_zerodim_and_defer[39m([38;5;124m"[39m[38;5;124m__add__[39m[38;5;124m"[39m)
[1;32m    101[0m [38;5;28;01mdef[39;00m [38;5;21m__add__[39m([38;5;28mself[39m, other):
[0;32m--> 102[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_arith_method[49m[43m([49m[43mother[49m[43m,[49m[43m [49m[43moperator[49m[38;5;241;43m.[39;49m[43madd[49m[43m)[49m

File [0;32m~/code_5820/data_analysis/lib/python3.10/site-packages/pandas/core/series.py:6259[0m, in [0;36mSeries._arith_method[0;34m(self, other, op)[0m
[1;32m   6257[0m [38;5;28;01mdef[39;00m [38;5;21m_arith_method[39m([38;5;28mself[39m, other, op):
[1;32m   6258[0m     [38;5;28mself[39m, other [38;5;241m=[39m ops[38;5;241m.[39malign_method_SERIES([38;5;28mself[39m, other)
[0;32m-> 6259[0m     [38;5;28;01mreturn[39;00m [43mbase[49m[38;5;241;43m.[39;49m[43mIndexOpsMixin[49m[38;5;241;43m.[39;49m[43m_arith_method[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43mother[49m[43m,[49m[43m [49m[43mop[49m[43m)[49m

File [0;32m~/code_5820/data_analysis/lib/python3.10/site-packages/pandas/core/base.py:1325[0m, in [0;36mIndexOpsMixin._arith_method[0;34m(self, other, op)[0m
[1;32m   1322[0m rvalues [38;5;241m=[39m ensure_wrapped_if_datetimelike(rvalues)
[1;32m   1324[0m [38;5;28;01mwith[39;00m np[38;5;241m.[39merrstate([38;5;28mall[39m[38;5;241m=[39m[38;5;124m"[39m[38;5;124mignore[39m[38;5;124m"[39m):
[0;32m-> 1325[0m     result [38;5;241m=[39m [43mops[49m[38;5;241;43m.[39;49m[43marithmetic_op[49m[43m([49m[43mlvalues[49m[43m,[49m[43m [49m[43mrvalues[49m[43m,[49m[43m [49m[43mop[49m[43m)[49m
[1;32m   1327[0m [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_construct_result(result, name[38;5;241m=[39mres_name)

File [0;32m~/code_5820/data_analysis/lib/python3.10/site-packages/pandas/core/ops/array_ops.py:226[0m, in [0;36marithmetic_op[0;34m(left, right, op)[0m
[1;32m    222[0m     _bool_arith_check(op, left, right)
[1;32m    224[0m     [38;5;66;03m# error: Argument 1 to "_na_arithmetic_op" has incompatible type[39;00m
[1;32m    225[0m     [38;5;66;03m# "Union[ExtensionArray, ndarray[Any, Any]]"; expected "ndarray[Any, Any]"[39;00m
[0;32m--> 226[0m     res_values [38;5;241m=[39m [43m_na_arithmetic_op[49m[43m([49m[43mleft[49m[43m,[49m[43m [49m[43mright[49m[43m,[49m[43m [49m[43mop[49m[43m)[49m  [38;5;66;03m# type: ignore[arg-type][39;00m
[1;32m    228[0m [38;5;28;01mreturn[39;00m res_values

File [0;32m~/code_5820/data_analysis/lib/python3.10/site-packages/pandas/core/ops/array_ops.py:165[0m, in [0;36m_na_arithmetic_op[0;34m(left, right, op, is_cmp)[0m
[1;32m    162[0m     func [38;5;241m=[39m partial(expressions[38;5;241m.[39mevaluate, op)
[1;32m    164[0m [38;5;28;01mtry[39;00m:
[0;32m--> 165[0m     result [38;5;241m=[39m [43mfunc[49m[43m([49m[43mleft[49m[43m,[49m[43m [49m[43mright[49m[43m)[49m
[1;32m    166[0m [38;5;28;01mexcept[39;00m [38;5;167;01mTypeError[39;00m:
[1;32m    167[0m     [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m is_cmp [38;5;129;01mand[39;00m (is_object_dtype(left[38;5;241m.[39mdtype) [38;5;129;01mor[39;00m is_object_dtype(right)):
[1;32m    168[0m         [38;5;66;03m# For object dtype, fallback to a masked operation (only operating[39;00m
[1;32m    169[0m         [38;5;66;03m#  on the non-missing values)[39;00m
[1;32m    170[0m         [38;5;66;03m# Don't do this for comparisons, as that will handle complex numbers[39;00m
[1;32m    171[0m         [38;5;66;03m#  incorrectly, see GH#32047[39;00m

File [0;32m~/code_5820/data_analysis/lib/python3.10/site-packages/pandas/core/computation/expressions.py:241[0m, in [0;36mevaluate[0;34m(op, a, b, use_numexpr)[0m
[1;32m    238[0m [38;5;28;01mif[39;00m op_str [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[1;32m    239[0m     [38;5;28;01mif[39;00m use_numexpr:
[1;32m    240[0m         [38;5;66;03m# error: "None" not callable[39;00m
[0;32m--> 241[0m         [38;5;28;01mreturn[39;00m [43m_evaluate[49m[43m([49m[43mop[49m[43m,[49m[43m [49m[43mop_str[49m[43m,[49m[43m [49m[43ma[49m[43m,[49m[43m [49m[43mb[49m[43m)[49m  [38;5;66;03m# type: ignore[misc][39;00m
[1;32m    242[0m [38;5;28;01mreturn[39;00m _evaluate_standard(op, op_str, a, b)

File [0;32m~/code_5820/data_analysis/lib/python3.10/site-packages/pandas/core/computation/expressions.py:70[0m, in [0;36m_evaluate_standard[0;34m(op, op_str, a, b)[0m
[1;32m     68[0m [38;5;28;01mif[39;00m _TEST_MODE:
[1;32m     69[0m     _store_test_result([38;5;28;01mFalse[39;00m)
[0;32m---> 70[0m [38;5;28;01mreturn[39;00m [43mop[49m[43m([49m[43ma[49m[43m,[49m[43m [49m[43mb[49m[43m)[49m

[0;31mValueError[0m: setting an array element with a sequence. The requested array has an inhomogeneous shape after 1 dimensions. The detected shape was (3,) + inhomogeneous part.

