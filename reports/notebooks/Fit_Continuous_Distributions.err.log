Traceback (most recent call last):
  File "/home/danbot2/code_5820/data_analysis/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/home/danbot2/code_5820/data_analysis/lib/python3.10/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/home/danbot2/code_5820/data_analysis/lib/python3.10/site-packages/jupyter_core/utils/__init__.py", line 166, in wrapped
    return loop.run_until_complete(inner)
  File "/usr/lib/python3.10/asyncio/base_events.py", line 649, in run_until_complete
    return future.result()
  File "/home/danbot2/code_5820/data_analysis/lib/python3.10/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/home/danbot2/code_5820/data_analysis/lib/python3.10/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/danbot2/code_5820/data_analysis/lib/python3.10/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# the 'process' variable is here so jupyter doesn't go computing 
# a million rows per iteration when the book is built for pushing to github pages.
reordered_bitrates = [4, 6, 8, 10, 12, 3, 5, 7, 9, 11]
process = True
partial_counts = False
if process: 
    for bitrate in reordered_bitrates:
        print(f'Processing pairs at {bitrate} bits quantization (partial counts={partial_counts})')
        results_fname = f'KL_parametric_fits_{bitrate}bits_{revision_date}.csv'

        out_fpath = os.path.join('data/', 'parametric_divergence_test', results_fname)
        if os.path.exists(out_fpath):
            continue

        n_batches = max(len(id_pairs) // batch_size, 1)
        batches = np.array_split(np.array(id_pairs, dtype=object), n_batches)
        n_pairs = len(id_pairs)
        print(
            f"    Processing {n_pairs} pairs in {n_batches} batches at {bitrate} bits"
        )
        batch_no = 1
        batch_files = []
        t0 = time()
        # error_df = error_model_df[error_model_df['bitrate'] == bitrate].copy()
        for batch_ids in batches:
            print(f'Starting batch {batch_no}/{len(batches)} processing.')
            batch_fname = results_fname.replace('.csv', f'_batch_{batch_no:03d}.csv')
            batch_output_fpath = os.path.join(temp_dir, batch_fname)
            if os.path.exists(batch_output_fpath):
                batch_files.append(batch_output_fpath)
                batch_no += 1
                continue
            
            # define the input array for multiprocessing
            inputs = input_batch_generator(bcub_gdf, batch_ids, bitrate,
                     min_years, partial_counts)

            with mp.Pool(20) as pool:
                results = pool.map(process_batch, inputs)
                results = [r for r in results if r is not None]

            batch_result = pd.DataFrame(results)
            if batch_result.empty:
                print('Empty batch.  Skipping')
            else:
                batch_result.to_csv(batch_output_fpath, index=False)
                print(f"    Saved {len(batch_result)} new results to file.")
            
            batch_files.append(batch_output_fpath)
            t2 = time()
            print(f'    Processed {len(batch_ids)} pairs at ({bitrate} bits) in {t2 - t0:.1f} seconds')
            batch_no += 1
            
        print(f'    Concatenating {len(batch_files)} batch files.')
        if len(batch_files) > 0:
            all_results = pd.concat([pd.read_csv(f, engine='pyarrow') for f in batch_files], axis=0)
            all_results.to_csv(out_fpath, index=False)
            if os.path.exists(out_fpath):
                for f in batch_files:
                    os.remove(f)
            print(f'    Wrote {len(all_results)} results to {out_fpath}')
        else:
            print('    No new results to write to file.')
------------------

----- stdout -----
Processing pairs at 4 bits quantization (partial counts=False)
Processing pairs at 6 bits quantization (partial counts=False)
Processing pairs at 8 bits quantization (partial counts=False)
Processing pairs at 10 bits quantization (partial counts=False)
Processing pairs at 12 bits quantization (partial counts=False)
Processing pairs at 3 bits quantization (partial counts=False)
Processing pairs at 5 bits quantization (partial counts=False)
Processing pairs at 7 bits quantization (partial counts=False)
Processing pairs at 9 bits quantization (partial counts=False)
Processing pairs at 11 bits quantization (partial counts=False)
    Processing 877150 pairs in 175 batches at 11 bits
Starting batch 1/175 processing.
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1464: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  np.minimum(upper_bounds[:, None], bin_edges_upper)
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
----- stderr -----
/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py:1465: FutureWarning: Support for multi-dimensional indexing (e.g. `obj[:, None]`) is deprecated and will be removed in a future version.  Convert to a numpy array before indexing instead.
  - np.maximum(lower_bounds[:, None], bin_edges_lower),
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mRemoteTraceback[0m                           Traceback (most recent call last)
[0;31mRemoteTraceback[0m: 
"""
Traceback (most recent call last):
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/usr/lib/python3.10/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
  File "/tmp/ipykernel_545972/3097646944.py", line 93, in process_batch
    p_obs, p_sim, bin_edges = process_probabilities(
  File "/tmp/ipykernel_545972/3028318634.py", line 21, in process_probabilities
    fractional_obs_counts = dpf.error_adjusted_fractional_bin_counts(
  File "/home/danbot2/code_5820/24/divergence_measures/docs/notebooks/data_processing_functions.py", line 1475, in error_adjusted_fractional_bin_counts
    extended_overlap_matrix[:, 1:-1] = overlap_matrix
ValueError: could not broadcast input array from shape (1754,2046) into shape (1754,2044)
"""

The above exception was the direct cause of the following exception:

[0;31mValueError[0m                                Traceback (most recent call last)
Cell [0;32mIn[27], line 39[0m
[1;32m     35[0m inputs [38;5;241m=[39m input_batch_generator(bcub_gdf, batch_ids, bitrate,
[1;32m     36[0m          min_years, partial_counts)
[1;32m     38[0m [38;5;28;01mwith[39;00m mp[38;5;241m.[39mPool([38;5;241m20[39m) [38;5;28;01mas[39;00m pool:
[0;32m---> 39[0m     results [38;5;241m=[39m [43mpool[49m[38;5;241;43m.[39;49m[43mmap[49m[43m([49m[43mprocess_batch[49m[43m,[49m[43m [49m[43minputs[49m[43m)[49m
[1;32m     40[0m     results [38;5;241m=[39m [r [38;5;28;01mfor[39;00m r [38;5;129;01min[39;00m results [38;5;28;01mif[39;00m r [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m]
[1;32m     42[0m batch_result [38;5;241m=[39m pd[38;5;241m.[39mDataFrame(results)

File [0;32m/usr/lib/python3.10/multiprocessing/pool.py:367[0m, in [0;36mPool.map[0;34m(self, func, iterable, chunksize)[0m
[1;32m    362[0m [38;5;28;01mdef[39;00m [38;5;21mmap[39m([38;5;28mself[39m, func, iterable, chunksize[38;5;241m=[39m[38;5;28;01mNone[39;00m):
[1;32m    363[0m [38;5;250m    [39m[38;5;124;03m'''[39;00m
[1;32m    364[0m [38;5;124;03m    Apply `func` to each element in `iterable`, collecting the results[39;00m
[1;32m    365[0m [38;5;124;03m    in a list that is returned.[39;00m
[1;32m    366[0m [38;5;124;03m    '''[39;00m
[0;32m--> 367[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_map_async[49m[43m([49m[43mfunc[49m[43m,[49m[43m [49m[43miterable[49m[43m,[49m[43m [49m[43mmapstar[49m[43m,[49m[43m [49m[43mchunksize[49m[43m)[49m[38;5;241;43m.[39;49m[43mget[49m[43m([49m[43m)[49m

File [0;32m/usr/lib/python3.10/multiprocessing/pool.py:774[0m, in [0;36mApplyResult.get[0;34m(self, timeout)[0m
[1;32m    772[0m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m[38;5;241m.[39m_value
[1;32m    773[0m [38;5;28;01melse[39;00m:
[0;32m--> 774[0m     [38;5;28;01mraise[39;00m [38;5;28mself[39m[38;5;241m.[39m_value

[0;31mValueError[0m: could not broadcast input array from shape (1754,2046) into shape (1754,2044)

